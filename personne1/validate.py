from rsa import *
from keys import *

char = b"""-----BEGIN CERTIFICATE-----
bm91aAoxMwooMTA3NzQzNjc0MjUxMTA3NzgxNjE3MDE4NTkxODk0NjA2OTkwMjI4
ODMzOTc0NzQ4MTM2NjY1NTIxNjk1MDQyMDYxNzE2Nzc1NjE3MDUyOTk0NjAwMjUw
MjgwMDc1MTgxMjk0OTYwNzY3MTQwMjIxNzU0NjUyMDUzMTU2Mzc1NDQ5MDE0NzIw
ODg2NTA3NDI3NTE5NDc5MjI2MTIzMzc4Nzg2MTgzMTIyODIzNDc5NDY4NTE1NjE3
NDE3ODEwNTk0OTQ5OTkxNDQwMzE4NDE1ODYzODYwNjY0MzA2MzE5NjQzMTU1OTgz
NjEyNzEzNDk5NTIzNDYwNjIwMDc0Mzk4NzQ0MjkxMTg1NTE3MjQ3NTIzNTcxODI2
NDc3NDUzNzg3NDgzMjMxOTgxMDE3MTE5MzE5ODY3LCA2NTUzNykKbm91aGEvYmVs
a2Evbm91aGFiZWxrYTIwMDFAZ21haWwuY29tCig4OTQyNDU2MjkwMjI1MDE0NDk4
Mzc0MzAzNzk5NTAwMjA2NjA2OTcwNjQzNjIyMzk4Njg2ODM3MTEwMjUwODEwNzUz
MTcwNjI4NjgyNTQ5MDU0NjYyMTQ1MjkyMDUwMDkwOTgwMzc3MTUyNzI0Nzk2NzQ1
Nzk2MTM5MzYwODg4OTY1NTM5ODg4NjU1MjA3MjczODM5NDY1MTMzNTI3NjY5MDEw
MjgwODU1MTEzOTM2NDEwMDE5OTc3MzQxNzM5MTI3MjQzOTE3NTE2NTE2ODgzNjc0
OTgzNTEwMDIxNzY1MDc4NDI2NDI4MDM1NzU2Nzc4MjMyODA2Njk0NTIzNzI5MTIy
OTI1ODc0MDc2NDQyNjM0MjgxOTM5NDIwNTE5MjAwMDA2MjczNTMyMzIzMTkzMDY1
MywgNjU1MzcpCnNoYTI1NgoyMDIzLTA0LTA2IDE1OjQ4OjQyLjIzNDI0OAoyMDI0
LTA0LTA1IDE1OjQ4OjQyLjIzNDI0OApzaWduCjU0NDI5MDYzNzE5MTA2NzM0NTk2
MDc3ODM2ODQzMjEzMTA4ODEzNTM3Njc4NTk4MDE1NjEzODM3NTc0NDU4NjcwMjg1
OTQwMTY3MDEwNzAwNTUwNjAyMjE5MzEyNDQ3ODY3NDYxNzQzNDQ4NzI2OTc3NDA3
NzIxNDY4MjU1NDA1NDY0MTA5Njc1MTIyNTk5NzMzMzk2Nzk5MDI5NTMxOTc2MjEz
Nzg2MjA3OTUyNjM0NjMyMjMzMDEzMjc5MzA4Njg4MDIyNDAyNDk5NDI2MDY0OTkx
NDg1NjUzMjkyOTU3ODE0MTU4NDk1NDM1ODc1OTA4OTMwOTI5NTE1NDk3MDIzMjM1
MzAwNzEwNDk5NzQxNTQ2NTk3NzE4MTUwNzc5NjgxNjA1OTYzMjQ2OTE0MTM4Mjc2
-----END CERTIFICATE-----"""

def decodeCsrCert(file_bytes):
    # pem decode
    dec = pem_decode(file_bytes.decode('utf-8')).decode('utf-8')


    #split content and signature
    withouSign = dec.split("sign")
    withouSign = withouSign[0].encode('utf-8') + b"sign\r\n"



    #split contents into list
    decList = dec.replace("\r", "").split("\n")

    return withouSign,decList

c,b = decodeCsrCert(char)
# print(c)
print(b)